<div class="container">
	<div class="d-flex justify-content-center">
		<div class="card mt-5 mb-5" style="width: 30rem">
			<div class="card-body">
				<h5 class="card-title text-center"><%= masyarakat.nama.toUpperCase() %></h5>

				<p class="card-subtitle mb-3 text-muted text-center">
					<%= masyarakat.golongan.toUpperCase() %>
				</p>

				<div class="row mb-2">
					<label class="col-sm-4 col-form-label">Nomor KK</label>
					<div class="col-sm-8">
						<input class="form-control" value="<%= masyarakat.no_KK %>" disabled />
					</div>
				</div>

				<div class="row mb-2">
					<label class="col-sm-4 col-form-label">NIK</label>
					<div class="col-sm-8">
						<input class="form-control" value="<%= masyarakat.NIK %>" disabled />
					</div>
				</div>

				<div class="row mb-2">
					<label class="col-sm-4 col-form-label">Alamat</label>
					<div class="col-sm-8">
						<input
							class="form-control"
							value="<%= masyarakat.dusun %>, <%= gampong.nama_gampong %>, <%=gampong.kecamatan %>, Aceh Besar"
							disabled
						/>
					</div>
				</div>

				<div class="row mb-2">
					<label class="col-sm-4 col-form-label">Dokumen Hasil dan Sketsa Pengukuran</label>
					<div class="col-sm-8">
						<% if (golongan.bobot_proposal == 1) { %>
						<input
							class="form-control"
							disabled
							value="Memiliki dokumen hasil dan sketsa pengukuran"
						/>
						<% } else { %>
						<input class="form-control" disabled value="Tidak Ada" />
						<% } %>
					</div>
				</div>

				<div class="row mb-2">
					<label class="col-sm-4 col-form-label">Akta Ikrar Wakaf (AIW)</label>
					<div class="col-sm-8">
						<% if (golongan.bobot_AIW == 1) { %>
						<input class="form-control" disabled value="Memiliki surat golongan" />
						<% } else { %>
						<input class="form-control" disabled value="Tidak Ada" />
						<% } %>
					</div>
				</div>

				<div class="row mb-2">
					<label class="col-sm-4 col-form-label">Waktu Proses</label>
					<div class="col-sm-8">
						<input class="form-control" disabled value="<%=
						masyarakat.waktu_proses.toLocaleDateString("id") %>" />
					</div>
				</div>
				<div class="row mb-2">
					<label class="col-sm-4 col-form-label">Update Data</label>
					<div class="col-sm-8">
						<input class="form-control" disabled value=" <%=
						masyarakat.updatedAt.toLocaleDateString("id") %>" />
					</div>
				</div>
				<div class="row mb-2">
					<label class="col-sm-4 col-form-label">Update Golongan</label>
					<div class="col-sm-8">
						<input class="form-control" disabled value="<%=
						golongan.updatedAt.toLocaleDateString("id") %>" />
					</div>
				</div>

				<div class="row text-center mb-2 mt-4">
					<% if (session?.user?.role=="staf") { %>
						<div class="col">
							<form
								action="/masyarakat/reset/<%= masyarakat.NIK %>?_method=PUT" method="POST"
							>
								<button
									type="button"
									class="btn btn-info badge"
									onclick="return confirmHandlerReset(this, '<%= masyarakat.nama %>')"
								>
									Reset
								</button>
								<input type="hidden" name="golongan" value="<%= masyarakat.golongan %>">
							</form>
						</div>
					<% } %>

					<% if (session?.user?.role=="gampong") { %>
					<div class="col">
						<a href="/masyarakat/edit/<%= masyarakat.NIK %>" class="btn btn-warning badge">Edit </a>
					</div>
					<div class="col">
						<a href="/<%= endpoint %>/edit/<%= masyarakat.NIK %>" class="btn btn-warning badge"
							>Edit Data Golongan</a
						>
					</div>
					<div class="col">
						<form
							action="/masyarakat/<%= masyarakat.NIK %>?_method=DELETE"
							id="formDelete"
							method="POST"
						>
							<button
								type="button"
								class="btn btn-danger badge"
								onclick="return confirmHandler(this, '<%= masyarakat.nama %>')"
							>
								Del
							</button>
						</form>
					</div>
					
				</div>
				<% } %>
				<div class="flex mt-5">
					<a href="#" class="btn btn-secondary badge" onclick="goBack()">Kembali</a>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
	function goBack() {
		window.history.back();
	}

	function confirmHandler(button, nama) {
		const swalWithBootstrapButtons = Swal.mixin({
			customClass: {
				confirmButton: "btn btn-success",
				cancelButton: "btn btn-danger",
			},
			buttonsStyling: false,
		});

		swalWithBootstrapButtons
			.fire({
				title: "Apakah anda yakin?",
				text: `menghapus data ${nama} ?`,
				icon: "warning",
				showCancelButton: true,
				confirmButtonText: "Ya, hapus!",
				cancelButtonText: "Batal!",
				reverseButtons: true,
			})
			.then((result) => {
				if (result.isConfirmed) {
					button.parentElement.submit();
					swalWithBootstrapButtons.fire("Deleted!", `Data ${nama} berhasil dihapus`, "success");
				} else if (
					/* Read more about handling dismissals below */
					result.dismiss === Swal.DismissReason.cancel
				) {
					swalWithBootstrapButtons.fire("Cancelled", `Data ${nama} masih tersimpan`, "error");
				}
			});
	}

	function confirmHandlerReset(button, nama) {
		const swalWithBootstrapButtons = Swal.mixin({
			customClass: {
				confirmButton: "btn btn-success",
				cancelButton: "btn btn-danger",
			},
			buttonsStyling: false,
		});

		swalWithBootstrapButtons
			.fire({
				title: "Apakah anda yakin?",
				text: `mereset data ${nama} ?`,
				icon: "warning",
				showCancelButton: true,
				confirmButtonText: "Ya, reset!",
				cancelButtonText: "Batal!",
				reverseButtons: true,
			})
			.then((result) => {
				if (result.isConfirmed) {
					button.parentElement.submit();
					swalWithBootstrapButtons.fire("Reset!", `Data ${nama} berhasil direset`, "success");
				} else if (
					/* Read more about handling dismissals below */
					result.dismiss === Swal.DismissReason.cancel
				) {
					swalWithBootstrapButtons.fire("Cancelled", `Data ${nama} masih tersimpan`, "error");
				}
			});
	}
</script>